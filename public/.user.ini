; ==============================================================================
; ZIMA Solutions - PHP Security Configuration for cPanel
; ==============================================================================
; This file hardens PHP settings at the application level.
; Place in the public directory for cPanel deployments.
; ==============================================================================

; ==============================================================================
; SECURITY SETTINGS
; ==============================================================================

; Hide PHP version from headers
expose_php = Off

; Disable error display in production (log instead)
display_errors = Off
display_startup_errors = Off

; Enable error logging
log_errors = On
error_log = ../storage/logs/php_errors.log

; Error reporting level (log all errors)
error_reporting = E_ALL

; ==============================================================================
; DANGEROUS FUNCTIONS
; ==============================================================================

; Disable functions that could be exploited
; Note: Some hosting providers may override this
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,curl_multi_exec,show_source,pcntl_exec,posix_kill,posix_mkfifo,posix_setpgid,posix_setsid,posix_setuid,dl,pfsockopen,symlink,link

; ==============================================================================
; SESSION SECURITY
; ==============================================================================

; Use cookies only (no URL session IDs)
session.use_cookies = 1
session.use_only_cookies = 1
session.use_trans_sid = 0

; Strict session mode
session.use_strict_mode = 1

; HTTP-only cookies (prevent JavaScript access)
session.cookie_httponly = 1

; Secure cookies (HTTPS only)
session.cookie_secure = 1

; SameSite cookie attribute
session.cookie_samesite = Strict

; Session ID length and bits
session.sid_length = 48
session.sid_bits_per_character = 6

; Session garbage collection
session.gc_maxlifetime = 7200
session.gc_probability = 1
session.gc_divisor = 100

; ==============================================================================
; FILE UPLOAD SETTINGS
; ==============================================================================

; Enable file uploads (needed for contact form attachments if added later)
file_uploads = On

; Maximum upload size
upload_max_filesize = 10M
post_max_size = 12M

; Maximum number of files per request
max_file_uploads = 5

; ==============================================================================
; RESOURCE LIMITS
; ==============================================================================

; Maximum execution time (30 seconds is sufficient)
max_execution_time = 30

; Maximum input time
max_input_time = 30

; Memory limit
memory_limit = 256M

; Maximum input variables
max_input_vars = 1000

; ==============================================================================
; URL/FILE ACCESS RESTRICTIONS
; ==============================================================================

; Prevent remote file inclusion attacks
allow_url_fopen = Off
allow_url_include = Off

; ==============================================================================
; OUTPUT SETTINGS
; ==============================================================================

; Output buffering
output_buffering = 4096

; Implicit flush
implicit_flush = Off

; ==============================================================================
; MISC SECURITY
; ==============================================================================

; Disable dynamic loading of extensions
enable_dl = Off

; SMTP security (if using PHP mail)
SMTP = localhost
smtp_port = 25

; ==============================================================================
; OPCACHE (Performance + Security)
; ==============================================================================

; Validate timestamps in production
; Set to 0 in production for better performance (requires cache clear on deploy)
opcache.validate_timestamps = 1
opcache.revalidate_freq = 60
